@model QuizCardModel
@using System
@using TdA26_CyganStudios.Models.Db
@using TdA26_CyganStudios.Utils

@{
    var quiz = Model.Quiz;
}

<div class="card h-100 position-relative">
    @if (Model.Editable)
    {
        <div class="dropdown position-absolute top-0 end-0 m-2">
            <button class="btn btn-sm bg-body-secondary p-1 text-muted" type="button" data-bs-toggle="dropdown"
                aria-expanded="false" style="line-height: 1;">
                <i class="bi bi-three-dots-vertical"></i>
            </button>

            <ul class="dropdown-menu dropdown-menu-end">
                <li>
                    <a class="dropdown-item" asp-page="/Dashboard/Course/Quizzes/Edit"
                        asp-route-courseUuid="@Model.CourseUuid" asp-route-quizUuid="@quiz.Uuid">
                        <i class="bi bi-pencil-square"></i> Edit
                    </a>
                </li>
                <li>
                    <form method="post" asp-page-handler="Delete" asp-route-itemUuid="@quiz.Uuid" asp-route-type="quiz"
                        onsubmit="return confirm('Are you sure you want to delete this quiz?');">

                        <button type="submit" class="dropdown-item text-danger">
                            <i class="bi bi-trash"></i> Delete
                        </button>
                    </form>
                </li>
            </ul>
        </div>
    }

    <div class="card-body">
        @if (Model.Editable)
        {
            <a asp-page="/Dashboard/Course/Quizzes/QuizDetails" asp-route-courseUuid="@Model.CourseUuid"
                asp-route-quizUuid="@quiz.Uuid">
                <h5 class="card-title mb-1">@quiz.Title</h5>
            </a>
        }
        else
        {
            <h5 class="card-title mb-1">@quiz.Title</h5>
            <button style="background-color: var(--lblue); border: none; text-decoration: none; padding: .2rem;"><a style="color: white;" asp-page="/Courses/TakeQuiz" asp-route-courseUuid="@Model.CourseUuid"
                    asp-route-quizUuid="@quiz.Uuid">Take</a></button>
        }
        <h6>Attempts count: @(quiz.AttemptsCount is { } attemptsCount ? attemptsCount.ToString() : "unlimited")</h6>
        <h6>Taken @(quiz.Submisions.Count) times</h6>
    </div>

</div>
